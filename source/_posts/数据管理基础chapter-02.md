---
title: 数据管理基础chapter_02
date: 2023-03-02 16:05:16
tags:
- 数据管理基础
categories:
- 数据管理基础
---

### 一、关系、关系模式和关系数据库

#### 域

域是一组具有相同数据类型的值的集合。

#### 笛卡尔积（Cartesian Product）

1.给定一组域D1，D2，…，Dn ，允许其中某些域是相同的。

2.D1，D2，…，Dn的笛卡尔积为
$$
D_{1} \times D_{2} \times ... \times D_{n} = \lbrace (d_{1},d_{2},...,d_{n}) \mid d_{i} \in D_{i},i = 1,2,...,n \rbrace
$$
性质：1)所有域的所有取值的一个组合 2)不能重复

##### 元组（Tuple）

笛卡尔积中每一个元素（d1，d2，…，dn）叫作一个n元组（n-tuple）或简称元组

##### 分量（Component）

笛卡尔积元素（d1，d2，…，dn）中的每一个值di叫作一个分量

##### 基数（Cardinal number）

若Di（i＝1，2，…，n）为有限集，其基数为mi （i ＝ 1，2，… ，n），则D1×D2×…×Dn的基数M为：
$$
M = \prod_{i = 1}^n m_{i}
$$

#### 关系（Relation）

D~1~,D~2~,D~3~,...,D~n~的笛卡尔积的子集叫做在域D~1~,D~2~,D~3~,...,D~n~上的关系，表示为R(D~1~,D~2~,D~3~,...,D~n~)

1.R：关系名

2.n：关系的目或度（Degree）

元组

1.关系中的每个元素是关系中的元组，通常用t表示

##### 关系的表示

关系也是一个二维表，表的每行对应一个元组，表的每列对应一个域

##### 属性

1.关系中不同列可以对应相同的域

2.为了加以区分，必须对每列起一个名字，称为属性（Attribute）

3.n目关系必有n个属性

##### 码

###### 候选码

1.若关系中的某一属性组的值能唯一地标识一个元组，而其子集不能，则称该属性组为候选码

2.简单的情况：候选码只包含一个属性

3.最极端的情况：关系模式的所有属性组是这个关系模式的候选码，称为全码（All-key）

###### 主码

若一个关系有多个候选码，则选定其中一个为主码（Primary key）

###### 主属性

1.候选码的诸属性称为主属性（Prime attribute）

2.不包含在任何侯选码中的属性称为非主属性（Non-Prime attribute）或非码属性（Non-key attribute） 

#### 关系的类别

##### 基本关系（基本表或基表）

实际存在的表，是实际存储数据的逻辑表示

##### 查询表

查询结果对应的表

##### 视图表

由基本表或其他视图表导出的表，是虚表，不对应实际存储的数据

#### 基本关系的性质

##### 列是同质的（Homogeneous）

每一列中的分量是同一类型的数据，来自同一个域

##### 不同的列可出自同一个域

1.其中的每一列称为一个属性

2.不同的属性要给予不同的属性名

##### 列的顺序无所谓

列的次序可以任意交换

##### 任意两个元组的候选码不能相同

##### 行的顺序无所谓

行的次序可以任意交换

##### 分量必须取原子值

#### 关系模式

1.关系模式（Relation Schema）是型，关系是值

2.关系模式是对关系的描述

3.关系模式可以形式化地表示为：R（U，D，DOM，F）

·R：关系名	

·U：组成该关系的属性名集合

·D：U中属性所来自的域

·DOM ：属性向域的映象集合

·F ：属性间数据的依赖关系的集合

4.关系模式通常可以简记为 R (U) 或 R (A1，A2，…，An)

·R : 关系名

·A1，A2，…，An : 属性名

注：域名及属性向域的映象常常直接说明为属性的类型、长度

#### 关系模式与关系

·关系模式

1.对关系的描述

2.静态的、稳定的

·关系

1.关系模式在某一时刻的状态或内容

2.动态的、随时间不断变化的

·关系模式和关系往往笼统称为关系

1.通过上下文加以区别

#### 关系数据库

##### 关系数据库

在一个给定的应用领域中，所有关系的集合构成一个关系数据库

##### 关系数据库的型和值

1.关系数据库的型: 关系数据库模式，是对关系数据库的描述

2.关系数据库的值: 关系模式在某一时刻对应的关系的集合，通常称为关系数据库

### 二、关系的完整性

#### 关系的三类完整性约束

1.实体完整性

2.参照完整性

说明：关系模型必须满足的完整性约束条件称为关系的两个不变性，应该由关系系统自动支持

3.用户定义的完整性

说明：应用领域需要遵循的约束条件，体现了具体领域中的语义约束

#### 实体完整性

##### 实体完整性规则

1.若属性A是基本关系R的主属性，则属性A不能取空值

2.空值就是“不知道”或“不存在”或“无意义”的值

##### 实体完整性规则的说明

1.实体完整性规则是针对基本关系而言的。一个基本表通常对应现实世界的一个实体集。

2.现实世界中的实体是可区分的，即它们具有某种唯一性标识。

3.关系模型中以主码作为唯一性标识。

4.主码中的属性即主属性不能取空值

#### 关系的引用

在关系模型中实体及实体间的联系都是用关系来描述的，自然存在着关系与关系间的引用

#### 外码

##### 定义

设F是基本关系R的一个或一组属性，但不是关系R的码。如果F与基本关系S的主码Ks相对应，则称F是R的外码（Foreign Key）

1.基本关系R称为参照关系（Referencing  Relation）

2.基本关系S称为被参照关系（Referenced Relation）或目标关系（Target Relation）

###### 说明

1.关系R和S不一定是不同的关系

2.目标关系S的主码Ks和参照关系的外码F必须定义在同一个（或一组）域上

3.外码并不一定要与相应的主码同名

#### 参照完整性规则

若属性（或属性组）F是基本关系R的外码,它与基本关系S的主码Ks相对应（基本关系R和S不一定是不同的关系），则对于R中每个元组在F上的值必须为：

1.或者取空值（F的每个属性值均为空值）

2.或者等于S中某个元组的主码值

#### 用户定义的完整性

1.针对某一具体关系数据库的约束条件，反映某一具体应用所涉及的数据必须满足的语义要求

2.关系模型应提供定义和检验这类完整性的机制，以便用统一的系统的方法处理它们，而不需由应用程序承担这一功能



### 三、关系操作与关系代数

#### 基本关系操作

##### 常用的关系操作：

查询操作：选择、投影、连接、除、并、差、交、笛卡尔积（选择、投影、并、差、笛卡尔积是5种基本操作）

数据更新：插入、删除、修改

##### 关系操作的特点：

集合操作方式：操作的对象和结果都是集合，一次一集合的方式

#### 关系代数

·关系代数是一种抽象的查询语言，用对关系的运算来表达查询

·运算对象和结果都是关系

·两类运算符：

1、集合运算符

2、专门的关系运算符

#### 关系代数运算符

##### 使用的记号1

设关系模式为R(A1，A2，…，An)

1.它的一个关系设为R

2.$$t \in R$$表示t是R的一个元组

3.t[A~i~]则表示元组t中相应于属性Ai的一个分量 

4.若A={A~i1~，A~i2~，…，A~ik~}，其中A~i1~，A~i2~，…，A~ik~是A~1~，A~2~，…，A~n~中的一部分，则A称为属性列或属性组。

5.t[A]=(t[A~i1~]，t[A~i2~]，…，t[A~ik~])表示元组t在属性列A上诸分量的集合。

6.$$\overline{A}$$则表示{A1，A2，…，An}中去掉{Ai1，Ai2，…，Aik}后剩余的属性组。

##### 使用的记号2

R为n目关系，S为m目关系

1.$$t_{r} \in R，t_{s} \in S$$， $$\widehat{t_{r}t_{s}}$$称为元组的连接

2.$$\widehat{t_{r}t_{s}}$$是一个n + m列的元组，前n个分量为R中的一个n元组，后m个分量为S中的一个m元组。

给定一个关系R（X，Z），X和Z为属性组

1.当t[X]=x时，x在R中的象集（Images Set）为
$$
Z_{x} = \lbrace t[Z] \mid t \in R,t[X] = x \rbrace
$$
2.它表示R中属性组X上值为x的诸元组在Z上分量的集合 

##### 集合运算符：

###### 一.并（Union）

R和S具有 1.相同的目n（即两个关系都有n个属性

2.相应的属性取自同一个域
$$
R\cup S = \lbrace t \mid t \in R \vee t \in S \rbrace
$$
###### 二.差（Difference）

R和S具有 1.相同的目n

2.相应的属性取自同一个域
$$
R - S = \lbrace t \mid t \in R \wedge t \notin S \rbrace
$$
###### 三.交（Intersection）

R和S具有1.相同的目n

2.相应的属性取自同一个域
$$
R \cap S = \lbrace t \mid t \in R \wedge t \in S \rbrace
$$
###### 四.笛卡尔积

严格地讲应该是广义的笛卡尔积（Extended Cartesian Product）
$$
R \times S = \lbrace \widehat{t_{r}  t_{s}} \mid t_{r} \in R \wedge t_{s} \in S \rbrace
$$

##### 专门的关系运算符：

###### 一.选择（Selection）又称限制（Restriction）

在关系R中选择满足给定条件的诸元组
$$
\sigma_{F}(R) = \lbrace t \mid t \in R \wedge F(t) = '真' \rbrace
$$
F：选择条件，是一个逻辑表达式，取值为“真”或“假”

1.基本形式为：X~1~θY~1~，θ表示比较运算符，它可以是＞，≥，＜，≤，＝或<>

2.在基本的选择条件上可以进一步进行逻辑运算（与，或，非）

选择运算是从关系R中选取使逻辑表达式F为真的元组，是从行的角度进行的运算

###### 二.投影（Projection）

从R中选择出若干属性列组成新的关系
$$
\Pi_{A}(R) = \lbrace t[A] \mid t \in R \rbrace \\
A:R中的属性列
$$
1.投影操作主要是从列的角度进行运算

2.投影之后不仅取消了原关系中的某些列，而且还可能取消某些元组（避免重复行）

###### 三.连接（Join）

·也称θ连接
$$
R \Join S = \lbrace \widehat{t_{r}  t_{s}} \mid t_{r} \in R \wedge t_{s} \in S \wedge t_{r}[A] \theta t_{s}[B] \rbrace \\
A和B：分别为R和S上度数相等且可比的属性组\\

\theta ：比较运算符
$$
连接运算从R和S的广义笛卡尔积R×S中选取R关系在A属性组上的值与S关系在B属性组上的值满足比较关系θ的元组 

·等值连接

1.θ为“＝”的连接运算称为等值连接

2.从关系R与S的广义笛卡尔积中选取A、B属性值相等的那些元组

·自然连接

一种特殊的等值连接

1.两个关系中进行比较的分量必须是相同的属性组

2.在结果中把重复的属性列去掉

总结：一般的连接操作是从行的角度进行运算，自然连接还需要取消重复列，所以是同时从行和列的角度进行运算。

###### 外连接

·悬浮元组（Dangling tuple）

1.两个关系R和S在做自然连接时，关系R中某些元组有可能在S中不存在公共属性上值相等的元组，从而造成R中这些元组在操作时被舍弃了，这些被舍弃的元组称为悬浮元组。

·外连接（Outer Join）

1.如果把悬浮元组也保存在结果关系中，而在其他属性上填空值(Null)，就叫做外连接

2.左外连接(LEFT OUTER JOIN或LEFT JOIN)

   只保留左边关系R中的悬浮元组

3.右外连接(RIGHT OUTER JOIN或RIGHT JOIN)

   只保留右边关系S中的悬浮元组

四.除运算（Division）

1.给定关系R (X，Y) 和S (Y，Z)，其中X，Y，Z为属性组。

2.R中的Y与S中的Y可以有不同的属性名，但必须出自相同的域集。

3.R与S的除运算得到一个新的关系P(X)，P是R中满足下列条件的元组在 X 属性列上的投影。
$$
P \div S = \lbrace t_{r}[X] \mid t_{r} \in R \wedge \Pi_{Y}(S) \subseteq Y_{X} \rbrace \\
Y_{X}：X在R中的象集，x = t_{r}[X]
$$
